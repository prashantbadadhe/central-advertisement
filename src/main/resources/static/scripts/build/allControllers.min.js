/*! redixile 2018-09-11 */

myApp.controller("BranchCreateController",["$uibModalInstance","$scope","branchService",function(t,n,a){n.branch={id:null,name:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",phone1:"",email1:"",company:"",status:""},n.createMode=!0,n.editMode=!1,n.companyList=[],n.newCompany="",n.onCancel=function(){t.dismiss("cancel")},n.save=function(){var e=n.companyList.filter(function(e){return e.id==n.newCompany});n.branch.company={},n.branch.company.id=e[0].id,n.branch.company.name=e[0].name,a.createBranch(n.branch).then(function(e){t.close({messageSuccess:"New record created successfuly"})},function(e){t.close({messageFail:"Fail to create new record. Please check the log"})})},n.getCompanies=function(){a.getCompanies().then(function(e){n.companyList=e.data._embedded.companies,null==n.companyList[0]||null==n.companyList[0]?n.newCompany="":n.newCompany=n.companyList[0].id.toString()},function(e){t.close({messageFail:"Fail to fetch company Details. Please check the log"}),$log.error("Fail to fetch company Details.")})},n.getCompanies()}]),myApp.controller("BranchEditController",["$uibModalInstance","$scope","items","branchService","$log",function(t,n,e,a,o){n.branch={id:null,name:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",phone1:"",email1:"",company:""},n.branch=e,n.editMode=!0,n.createMode=!1,n.companyList=[],n.newCompany="",n.onCancel=function(){t.dismiss("cancel")},n.getCompanies=function(){a.getCompanies().then(function(e){n.companyList=e.data._embedded.companies,null!=n.branch.company&&(n.newCompany=n.branch.company.id.toString())},function(e){t.close({messageFail:"Fail to fetch company Details. Please check the log"}),o.error("Fail to fetch company Details.")})},n.save=function(){console.log(n.newCompany);var e=n.companyList.filter(function(e){return e.id==n.newCompany});n.branch.company=e[0],delete n.branch.company._links,delete n.branch._links,delete n.branch.registered,delete n.branch.slno,a.updateBranch(n.branch).then(function(e){t.close({messageSuccess:"Record updated successfuly"})},function(e){t.close({messageFail:"Fail to update. Please check the log"}),o.error("Fail to update")})},n.getCompanies()}]),myApp.controller("BranchController",["$scope","$http","$uibModal","branchService","$filter","$interval","$timeout","uiGridConstants",function(t,e,n,o,a,l,i,s){var r=this;r.branch={id:null,name:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",phone1:"",email1:"",company:""},r.responeData=[],r.gridOptions=[],r.showSuccessAlert=!1,r.messageSuccessText="",t.messageFailText="",r.showModal=!1,t.alerts=[],r.enableDeleteButton=0,t.pageName="Branch",t.pageUrl="branch",r.gridOptions={data:r.responeData,enableHighlighting:!0,enableRowHeaderSelection:!1,enableSorting:!0,exporterMenuCsv:!1,enableGridMenu:!0,paginationPageSizes:[25,50,75],paginationPageSize:15,enableColumnResizing:!0,enableRowSelection:!0,appScopeProvider:{onDblClick:function(e){r.openEditModal(e)}},rowTemplate:"../partials/uiGridTemplate.html",onRegisterApi:function(e){r.gridApi=e,r.gridApi.core.handleWindowResize(),e.selection.on.rowSelectionChanged(t,function(e){e.isSelected?r.enableDeleteButton=r.enableDeleteButton+1:r.enableDeleteButton=r.enableDeleteButton-1}),e.selection.on.rowSelectionChangedBatch(t,function(e){var t="rows changed "+e.length;console.log(t)})},columnDefs:[{name:"slno",width:70,enableFiltering:!1,cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"name",displayName:"Branch Name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"addressLine1",enableCellEdit:!0,displayName:"Address",cellClass:"noborder",cellTemplate:'<span>{{row.entity.addressLine1}}<span ng-if = "row.entity.addressLine2.length!=0">, </span> {{row.entity.addressLine2}} <span ng-if = "row.entity.city.length!=0">, City:</span> {{row.entity.city}}<span ng-if = "row.entity.state.length!=0">, State:</span>{{row.entity.state}}<span ng-if = "row.entity.country.length!=0">, Country:</span>{{row.entity.country}}<span ng-if = "row.entity.zipcode.length!=0">, zipcode:</span> {{row.entity.zipcode}}</span>',cellTooltip:"Select to delete and dubble click to edit"},{field:"phone1",displayName:" Phones",cellClass:"noborder",cellTemplate:'<span>{{row.entity.phone1}} <span ng-if = "row.entity.phone2.length!=0"> / </span>{{row.entity.phone2}}</span>',cellTooltip:"Select to delete and dubble click to edit"},{field:"email1",displayName:" Emails",cellClass:"noborder",cellTemplate:'<span>{{row.entity.email1}}<span ng-if = "row.entity.email2.length!=0"> / </span> {{row.entity.email2}}</span>',cellTooltip:"Select to delete and dubble click to edit"},{field:"company.name",displayName:"Company Name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"}]},r.deleteSelected=function(){function n(e){r.enableDeleteButton=0,t.showSuccessAlert("Record deleted successfully")}function a(e){t.showFailAlert("Fail to delete record"+e.data.message)}angular.forEach(r.gridApi.selection.getSelectedRows(),function(e,t){r.gridOptions.data.splice(r.gridOptions.data.lastIndexOf(e),1),o.deleteBranch(e).then(n,a)})},r.openEditModal=function(e){n.open({templateUrl:"../partials/branchInputs.html",controller:"BranchEditController",resolve:{items:function(){return e.entity}}}).result.then(function(e){e.messageSuccess?(r.enableDeleteButton=0,r.getBranch(),t.showSuccessAlert(e.messageSuccess)):t.showFailAlert(e.messageFail)},function(){})},r.openCreateModal=function(){n.open({templateUrl:"../partials/branchInputs.html",controller:"BranchCreateController"}).result.then(function(e){r.getBranch(),e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},t.showSuccessAlert=function(e){t.messageSuccessText=e,t.alerts.push(e),i(function(){t.messageSuccessText="",t.alerts.splice(t.alerts.indexOf(alert),1)},3e3)},t.showFailAlert=function(e){t.messageFailText=e,t.alerts.push(e),i(function(){t.messageFailText="",t.alerts.splice(t.alerts.indexOf(alert),1)},3e3)},r.getBranch=function(){0<r.responeData.length&&(r.responeData.length=[]),o.getBranches().then(function(e){r.pushGridData(e.data._embedded.branches)},function(e){console.log("Some erorr occure"+e)})},r.pushGridData=function(e){var t=1;e.forEach(function(e){e.slno=t,t++,e.registered=new Date(e.registered),r.responeData.push(e)})},r.getBranch(),r.refreshData=function(){r.gridOptions.data=a("filter")(r.responeData,r.searchText,void 0)},setSidebarMenuSelection("branch")}]),myApp.controller("BranchCodeController",["$rootScope","$window","branchCodeService","$scope","$timeout",function(e,t,n,a,o){setSidebarMenuSelection("branchcode"),e.logoutClicked=!1,a.uploadResult="",a.pageName="Branch Code",a.pageUrl="branchcode",a.activationCode="",a.branch=1,a.branchList=[],a.branchDetails={},a.msg={},a.rowDataArray=[],a.rowData={},a.duration=1,a.applyToAll=!1,a.messageSuccessText="",a.messageFailText="",a.alerts=[],a.getBranches=function(){n.getBranches().then(function(e){a.branchList=e.data._embedded.branches,a.branch="1",a.activationCode=e.data._embedded.branches[0].activateCode},function(e){$log.error("Fail to generate branch activation code.")})},a.getActivationCode=function(e){for(i=0;i<a.branchList.length;i++)a.branchList[i].id==e&&(a.activationCode=a.branchList[i].activateCode)},a.updateActivationCd=function(){n.updateActivationCode(a.branch).then(function(e){for(i=0;i<a.branchList.length;i++)a.branchList[i].id==e.data.id&&(a.branchList[i].activateCode=e.data.activateCode,a.activationCode=e.data.activateCode);a.showSuccessAlert("Branch code generated successfully"),console.log("Branch code generated successfully")},function(e){console.log(e),a.showFailAlert("Fail to generate branch code. Please check the log"),console.log("Branch code update Fail")})},a.showSuccessAlert=function(e){a.messageSuccessText=e,a.alerts.push(e),o(function(){a.messageSuccessText="",a.alerts.splice(a.alerts.indexOf(alert),1)},3e3)},a.showFailAlert=function(e){a.messageFailText=e,a.alerts.push(e),o(function(){a.messageFailText="",a.alerts.splice(a.alerts.indexOf(alert),1)},3e3)},a.getActivationCode(),a.getBranches()}]),myApp.controller("CompanyController",["$scope","$http","$uibModal","companyService","$filter","$interval","$timeout","uiGridConstants","$log",function(t,e,n,o,a,l,i,s,r){var c=this;c.company={id:null,name:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",lattitude:"",longitude:"",phone1:"",phone2:"",email1:"",email2:""},c.responeData=[],c.gridOptions=[],c.showSuccessAlert=!1,c.messageSuccessText="",t.messageFailText="",c.showModal=!1,t.alerts=[],c.enableDeleteButton=0,t.pageName="Company",t.pageUrl="company",c.gridOptions={data:c.responeData,enableHighlighting:!0,enableRowHeaderSelection:!1,enableSorting:!0,exporterMenuCsv:!1,enableGridMenu:!0,paginationPageSizes:[25,50,75],paginationPageSize:15,enableColumnResizing:!0,enableRowSelection:!0,appScopeProvider:{onDblClick:function(e){c.openEditModal(e)}},rowTemplate:"../partials/uiGridTemplate.html",onRegisterApi:function(e){c.gridApi=e,c.gridApi.core.handleWindowResize(),e.selection.on.rowSelectionChanged(t,function(e){e.isSelected?c.enableDeleteButton=c.enableDeleteButton+1:c.enableDeleteButton=c.enableDeleteButton-1}),e.selection.on.rowSelectionChangedBatch(t,function(e){var t="rows changed "+e.length;console.log(t)})},columnDefs:[{name:"id",width:50,enableFiltering:!1,cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"name",displayName:"name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"addressLine1",enableCellEdit:!0,displayName:"Address",cellClass:"noborder",cellTemplate:'<span>{{row.entity.addressLine1}}<span ng-if = "row.entity.addressLine2.length!=0">, </span> {{row.entity.addressLine2}} <span ng-if = "row.entity.city.length!=0">, City:</span> {{row.entity.city}}<span ng-if = "row.entity.state.length!=0">, State:</span>{{row.entity.state}}<span ng-if = "row.entity.country.length!=0">, Country:</span>{{row.entity.country}}<span ng-if = "row.entity.zipcode.length!=0">, zipcode:</span> {{row.entity.zipcode}}</span>',cellTooltip:"Select to delete and dubble click to edit"},{field:"phone1",displayName:" Phones",cellClass:"noborder",cellTemplate:'<span>{{row.entity.phone1}} <span ng-if = "row.entity.phone2.length!=0"> / </span>{{row.entity.phone2}}</span>',cellTooltip:"Select to delete and dubble click to edit"},{field:"email1",displayName:" Emails",cellClass:"noborder",cellTemplate:'<span>{{row.entity.email1}}<span ng-if = "row.entity.email2.length!=0"> / </span> {{row.entity.email2}}</span>',cellTooltip:"Select to delete and dubble click to edit"}]},c.deleteSelected=function(){function n(e){c.enableDeleteButton=0,t.showSuccessAlert("Record deleted successfully"),c.getCompany()}function a(e){-1!=e.data.message.search("could not execute statement")?(t.showFailAlert("Fail to delete record : Either database is down or there is branch recored exists for this company. Please check log for more details."),r.error("Fail to delete record : Either database is down or there is branch recored exists for this company : "+e.data.message)):(t.showFailAlert("Fail to delete record : "),r.error("Fail to delete record : "+e.data.message)),c.getCompany()}angular.forEach(c.gridApi.selection.getSelectedRows(),function(e,t){c.gridOptions.data.splice(c.gridOptions.data.lastIndexOf(e),1),o.deleteCompnay(e).then(n,a)})},c.openEditModal=function(e){n.open({templateUrl:"../partials/companyInputs.html",controller:"CompanyEditController",resolve:{items:function(){return e.entity}}}).result.then(function(e){e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},c.openCreateModal=function(){n.open({templateUrl:"../partials/companyInputs.html",controller:"CompanyCreateController"}).result.then(function(e){c.getCompany(),e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},t.showSuccessAlert=function(e){t.messageSuccessText=e,t.alerts.push(e),i(function(){t.messageSuccessText="",t.alerts.splice(t.alerts.indexOf(alert),1)},5e3)},t.showFailAlert=function(e){t.messageFailText=e,t.alerts.push(e),i(function(){t.messageFailText="",t.alerts.splice(t.alerts.indexOf(alert),1)},1e4)},c.getCompany=function(){0<c.responeData.length&&(c.responeData.length=[]),o.getCompanies().then(function(e){c.pushGridData(e.data._embedded.companies)},function(e){console.log("Some erorr occure"+e)})},c.pushGridData=function(e){var t=1;e.forEach(function(e){e.id=t,t++,e.registered=new Date(e.registered),c.responeData.push(e)})},c.getCompany(),c.refreshData=function(){c.gridOptions.data=a("filter")(c.responeData,c.searchText,void 0)},setSidebarMenuSelection("company")}]),myApp.controller("CompanyCreateController",["$uibModalInstance","$scope","companyService",function(t,e,n){e.company={id:null,name:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",lattitude:"",longitude:"",phone1:"",phone2:"",email1:"",email2:""},e.createMode=!0,e.editMode=!1,e.mandatoryFieldReq=!1,e.onCancel=function(){t.dismiss("cancel")},e.changeMandatoryField=function(){e.mandatoryFieldReq=!1},e.save=function(){0==e.company.name.trim().length?e.mandatoryFieldReq=!0:(e.mandatoryFieldReq=!1,n.createCompany(e.company).then(function(e){t.close({messageSuccess:"New record created successfuly"})},function(e){t.close({messageFail:"Fail to create new record. Please check the log"})}))}}]),myApp.controller("CompanyEditController",["$uibModalInstance","$scope","items","companyService",function(t,e,n,a){e.company={id:null,name:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",lattitude:"",longitude:"",phone1:"",phone2:"",email1:"",email2:""},e.company=n,e.editMode=!0,e.createMode=!1,e.mandatoryFieldReq=!1,e.onCancel=function(){t.dismiss("cancel")},e.changeMandatoryField=function(){e.mandatoryFieldReq=!1},e.save=function(){null==e.company.name?e.mandatoryFieldReq=!0:(e.mandatoryFieldReq=!1,a.updateCompany(e.company).then(function(e){t.close({messageSuccess:"Record updated successfuly"})},function(e){t.close({messageFail:"Fail to update. Please check the log"})}))}}]),myApp.controller("DashboardController",["$rootScope","$window","dashboardService","$scope",function(e,t,n,a){setSidebarMenuSelection("dashboard"),e.logoutClicked=!1,a.companiesCount=0,a.branchesCount=0,a.rolesCount=0,a.departmentsCount=0,n.getBranchDetails().then(function(e){a.branchesCount=e.data.page.totalElements})}]),myApp.controller("DepartmentCreateController",["$uibModalInstance","$scope","departmentService",function(t,n,a){n.department={id:null,name:"",type:"",branch:"",createdAt:"",updatedAt:""},n.createMode=!0,n.editMode=!1,n.branchList=[],n.newBranch="",n.onCancel=function(){t.dismiss("cancel")},n.save=function(){var e=n.branchList.filter(function(e){return e.id==n.newBranch});n.department.branch={},n.department.branch.id=e[0].id,n.department.branch.name=e[0].name,a.createDepartment(n.department).then(function(e){t.close({messageSuccess:"New record created successfuly"})},function(e){t.close({messageFail:"Fail to create new record. Please check the log"})})},n.getBranches=function(){a.getBranches().then(function(e){n.branchList=e.data._embedded.branches,n.newBranch=n.branchList[0].id.toString()},function(e){t.close({messageFail:"Fail to fetch branch Details. Please check the log"}),$log.error("Fail to fetch branch Details.")})},n.getBranches()}]),myApp.controller("DepartmentEditController",["$uibModalInstance","$scope","items","departmentService","$log",function(t,n,e,a,o,l){n.department={name:"",type:"",branch:"",createdAt:"",updatedAt:""},n.department=e,n.editMode=!0,n.createMode=!1,n.branchList=[],n.newBranch="",n.onCancel=function(){t.dismiss("cancel")},n.getBranches=function(){a.getBranches().then(function(e){n.branchList=e.data._embedded.branches,null!=n.department.branch&&(n.newBranch=n.department.branch.id.toString())},function(e){t.close({messageFail:"Fail to fetch branch Details. Please check the log"}),o.error("Fail to fetch branch Details.")})},n.save=function(){console.log(n.newBranch);var e=n.branchList.filter(function(e){return e.id==n.newBranch});n.department.branch=e[0],delete n.department.branch._links,delete n.department._links,delete n.department.registered,delete n.department.slno,a.updateDepartment(n.department).then(function(e){t.close({messageSuccess:"Record updated successfuly"})},function(e){t.close({messageFail:"Fail to update. Please check the log"}),o.error("Fail to update")})},n.getBranches()}]),myApp.controller("DepartmentController",["$scope","$http","$uibModal","departmentService","$filter","$interval","$timeout","uiGridConstants",function(t,e,n,o,a,l,i,s){var r=this;r.department={name:"",type:"",branch:"",createdAt:"",updatedAt:""},r.responeData=[],r.gridOptions=[],r.showSuccessAlert=!1,r.messageSuccessText="",t.messageFailText="",r.showModal=!1,t.alerts=[],r.enableDeleteButton=0,t.pageName="Department",t.pageUrl="department",r.gridOptions={data:r.responeData,enableHighlighting:!0,enableRowHeaderSelection:!1,enableSorting:!0,exporterMenuCsv:!1,enableGridMenu:!0,paginationPageSizes:[25,50,75],paginationPageSize:15,enableColumnResizing:!0,enableRowSelection:!0,appScopeProvider:{onDblClick:function(e){r.openEditModal(e)}},rowTemplate:"../partials/uiGridTemplate.html",onRegisterApi:function(e){r.gridApi=e,r.gridApi.core.handleWindowResize(),e.selection.on.rowSelectionChanged(t,function(e){e.isSelected?r.enableDeleteButton=r.enableDeleteButton+1:r.enableDeleteButton=r.enableDeleteButton-1}),e.selection.on.rowSelectionChangedBatch(t,function(e){var t="rows changed "+e.length;console.log(t)})},columnDefs:[{name:"slno",width:50,enableFiltering:!1,cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"name",displayName:"Department Name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"type",displayName:"Department Type",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"branch.name",displayName:"Branch Name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"createdAt",displayName:"Created Date",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"updatedAt",displayName:"Updated Date",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"}]},r.deleteSelected=function(){function n(e){r.enableDeleteButton=0,t.showSuccessAlert("Record deleted successfully")}function a(e){t.showFailAlert("Fail to delete record"+e.data.message)}angular.forEach(r.gridApi.selection.getSelectedRows(),function(e,t){r.gridOptions.data.splice(r.gridOptions.data.lastIndexOf(e),1),o.deleteDepartment(e).then(n,a)})},r.openEditModal=function(e){n.open({templateUrl:"../partials/departmentInputs.html",controller:"DepartmentEditController",resolve:{items:function(){return e.entity}}}).result.then(function(e){e.messageSuccess?(r.enableDeleteButton=0,r.getDepartment(),t.showSuccessAlert(e.messageSuccess)):t.showFailAlert(e.messageFail)},function(){})},r.openCreateModal=function(){n.open({templateUrl:"../partials/departmentInputs.html",controller:"DepartmentCreateController"}).result.then(function(e){r.getDepartment(),e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},t.showSuccessAlert=function(e){t.messageSuccessText=e,t.alerts.push(e),i(function(){t.messageSuccessText="",t.alerts.splice(t.alerts.indexOf(alert),1)},3e3)},t.showFailAlert=function(e){t.messageFailText=e,t.alerts.push(e),i(function(){t.messageFailText="",t.alerts.splice(t.alerts.indexOf(alert),1)},3e3)},r.getDepartment=function(){0<r.responeData.length&&(r.responeData.length=[]),o.getDepartments().then(function(e){r.pushGridData(e.data._embedded.departments)},function(e){console.log("Some erorr occure"+e)})},r.pushGridData=function(e){var t=1;e.forEach(function(e){e.slno=t,t++,e.registered=new Date(e.registered),r.responeData.push(e)})},r.getDepartment(),r.refreshData=function(){r.gridOptions.data=a("filter")(r.responeData,r.searchText,void 0)},setSidebarMenuSelection("department")}]),myApp.controller("HomeController",["$rootScope","$scope","$http","$timeout","$interval","uiGridConstants","uiGridGroupingConstants","$location",function(e,t,n,a,o,l,i,s){function r(e){n.get("api/categories").then(function(e){t.myData=e.data._embedded.categories},function(e){})}function c(e){}console.log(e),e.authenticated||(n.get("/login").then(r,c),window.location="/#!/"),n.get("/home").then(r,c)}]),myApp.controller("IndexController",["$rootScope","$scope","$http","$location","indexService","$sce",function(t,n,e,a,o,l){n.menu="",n.count=0,n.userDetails={},n.nextWeekJob="",n.projectNames={},n.projectName="",n.logout=function(){t.logoutClicked=!0,e.get("logout").then(function(e){t.authenticated=!0,window.location.href="/loginpage.html"},function(e){t.authenticated=!1,window.location.href="/loginpage.html",console.log("Some erorr occure"+e)})},n.renderHtml=function(){if(n.count<1){n.count=n.count+1,o.getMenuDetails().then(function(e){return n.count=n.count+1,n.userDetails.firstName=e.firstName,n.userDetails.userId=e.userId,n.userDetails.userName=e.userName,n.userDetails.firstName=e.firstName,n.userDetails.lastName=e.lastName,n.userDetails.email=e.email,n.userDetails.roleId=e.roleId,n.userDetails.roleName=e.roleName,n.userDetails.isEmployee=e.isEmployee,n.userDetails},function(e){n.count=n.count+1,$uibModalInstance.close({messageFail:"Fail to fetch company Details. Please check the log"}),$log.error("Fail to fetch company Details.")})}},n.menuObject=[{liclass:"dashboard",ngshow:"authenticated",nghref:"#!/dashboard",iclass:"icon-home",spanclass:"title",screenName:"Dashboard",selectclass:"selected",role:"admin",role1:"user"},{liclass:"branch",ngshow:"authenticated",nghref:"#!/branch",iclass:"glyphicon glyphicon-leaf",spanclass:"title",screenName:"Branches",selectclass:"selected",role:"admin",role1:"user"},{liclass:"fileupload",ngshow:"authenticated",nghref:"#!/fileupload",iclass:"glyphicon glyphicon-screenshot",spanclass:"title",screenName:"File Upload",selectclass:"selected",role:"admin",role1:"user"},{liclass:"branchcode",ngshow:"authenticated",nghref:"#!/branchcode",iclass:"glyphicon glyphicon-lock",spanclass:"title",screenName:"Get Branch Code",selectclass:"selected",role:"admin"},,{liclass:"user",ngshow:"authenticated",nghref:"#!/user",iclass:"glyphicon glyphicon-user",spanclass:"title",screenName:"Users",selectclass:"selected",role:"admin"},{liclass:"role",ngshow:"authenticated",nghref:"#!/role",iclass:"glyphicon glyphicon-grain",spanclass:"title",screenName:"Roles",selectclass:"selected",role:"admin"},{liclass:"aboutUs",ngshow:"authenticated",nghref:"#!/aboutUs",iclass:"icon-users",spanclass:"title",screenName:"About Us",selectclass:"selected",role:"admin",role1:"user"}],n.topMenuAdmin=[{liclass:"branchcode",ngshow:"authenticated",nghref:"#!/branchcode",iclass:"glyphicon glyphicon-lock",spanclass:"title",screenName:"Get Branch Code",selectclass:"selected",role:"admin"},{liclass:"user",ngshow:"authenticated",nghref:"#!/user",iclass:"glyphicon glyphicon-user",spanclass:"title",screenName:"Users",selectclass:"selected",role:"admin"},{liclass:"role",ngshow:"authenticated",nghref:"#!/role",iclass:"glyphicon glyphicon-grain",spanclass:"title",screenName:"Roles",selectclass:"selected",role:"admin"}]}]),myApp.controller("LandingController",["$scope","$http","uiGridConstants",function(a,o,e){var n={sort:null};a.gridOptions={paginationPageSizes:[25,50,75],paginationPageSize:25,useExternalPagination:!0,useExternalSorting:!0,enableGridMenu:!0,columnDefs:[{name:"name"},{name:"gender",enableSorting:!1},{name:"company",enableSorting:!1}],exporterAllDataFn:function(){return l(1,a.gridOptions.totalItems,n.sort).then(function(){a.gridOptions.useExternalPagination=!1,a.gridOptions.useExternalSorting=!1,l=null})},onRegisterApi:function(e){a.gridApi=e,a.gridApi.core.on.sortChanged(a,function(e,t){l&&(0<t.length?n.sort=t[0].sort.direction:n.sort=null,l(e.options.paginationCurrentPage,e.options.paginationPageSize,n.sort))}),e.pagination.on.paginationChanged(a,function(e,t){l&&l(e,t,n.sort)})}};var l=function(e,t,n){o.get("api/suppliers").then(function(e){a.gridOptions.totalItems=100,a.gridOptions.data=e},function(e){})};l(1,a.gridOptions.paginationPageSize)}]),myApp.controller("LoginController",["$rootScope","$scope","$http","$location","$window","loginService",function(t,e,n,a,o,l){var i=e;function s(e){e?(o.location.href=o.location.origin+"#!/dashboard",t.authenticated=!0,t.xxx="abhishekgautam",i.error=!1):(t.authenticated=!1,a.path("/"),o.location.href=o.location.origin,i.error=!0)}function r(e){i.attempt?(i.hideshow="",i.failToLogin="Login Fail Please check your user name and password !",console.log("Some erorr occure"+e)):i.attempt=!0}i.credentials={},i.failToLogin="",i.attempt=!1,i.hideshow="hide",t.logoutClicked&&l.authenticate().then(s,r),i.login=function(){t.logoutClicked=!1,l.authenticate(i.credentials).then(s,r)},i.forgotPassword=function(){alert("This feature is not available yet. Please contant adming team! Thanks")}}]),myApp.controller("RegisterController",function(t,e,n){var a=this;a.registration={id:null,username:"",password:""},a.passwordconfirmation="",t.register=function(){if(a.passwordconfirmation!=a.registration.password)n.path("/register");else{e.post("users",a.registration).then(function(e){n.path("/dashboard")},function(e){t.error=!0})}},t.items=["The first choice!","And another choice for you.","but wait! A third!"],t.status={isopen:!1},t.toggled=function(e){$log.log("Dropdown is now: ",e)},t.toggleDropdown=function(e){e.preventDefault(),e.stopPropagation(),t.status.isopen=!t.status.isopen},t.appendToEl=angular.element(document.querySelector("#dropdown-long-content"))}),myApp.controller("RoleCreateController",["$uibModalInstance","$scope","roleService",function(t,e,n){e.role={id:null,name:""},e.createMode=!0,e.editMode=!1,e.mandatoryFieldReq=!1,e.onCancel=function(){t.dismiss("cancel")},e.changeMandatoryField=function(){e.mandatoryFieldReq=!1},e.save=function(){0==e.role.name.trim().length?e.mandatoryFieldReq=!0:(e.mandatoryFieldReq=!1,n.createRole(e.role).then(function(e){t.close({messageSuccess:"New record created successfuly"})},function(e){t.close({messageFail:"Fail to create new record. Please check the log"})}))}}]),myApp.controller("RoleEditController",["$uibModalInstance","$scope","items","roleService",function(t,e,n,a){e.role={id:null,name:""},e.role=n,e.editMode=!0,e.createMode=!1,e.mandatoryFieldReq=!1,e.onCancel=function(){t.dismiss("cancel")},e.changeMandatoryField=function(){e.mandatoryFieldReq=!1},e.save=function(){null==e.role.name?e.mandatoryFieldReq=!0:(e.mandatoryFieldReq=!1,a.updateRole(e.role).then(function(e){t.close({messageSuccess:"Record updated successfuly"})},function(e){t.close({messageFail:"Fail to update. Please check the log"})}))}}]),myApp.controller("RoleController",["$scope","$http","$uibModal","roleService","$filter","$interval","$timeout","uiGridConstants","$log",function(t,e,n,o,a,l,i,s,r){var c=this;c.role={id:null,name:""},c.responeData=[],c.gridOptions=[],c.showSuccessAlert=!1,c.messageSuccessText="",t.messageFailText="",c.showModal=!1,t.alerts=[],c.enableDeleteButton=0,t.pageName="Role",t.pageUrl="role",c.gridOptions={data:c.responeData,enableHighlighting:!0,enableRowHeaderSelection:!1,enableSorting:!0,exporterMenuCsv:!1,enableGridMenu:!0,paginationPageSizes:[25,50,75],paginationPageSize:15,enableColumnResizing:!0,enableRowSelection:!0,appScopeProvider:{onDblClick:function(e){c.openEditModal(e)}},rowTemplate:"../partials/uiGridTemplate.html",onRegisterApi:function(e){c.gridApi=e,c.gridApi.core.handleWindowResize(),e.selection.on.rowSelectionChanged(t,function(e){e.isSelected?c.enableDeleteButton=c.enableDeleteButton+1:c.enableDeleteButton=c.enableDeleteButton-1}),e.selection.on.rowSelectionChangedBatch(t,function(e){var t="rows changed "+e.length;console.log(t)})},columnDefs:[{name:"id",width:50,enableFiltering:!1,cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"name",displayName:"name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"}]},c.deleteSelected=function(){function n(e){c.enableDeleteButton=0,t.showSuccessAlert("Record deleted successfully"),c.getRole()}function a(e){-1!=e.data.message.search("could not execute statement")?(t.showFailAlert("Fail to delete record : Either database is down or there is branch recored exists for this role. Please check log for more details."),r.error("Fail to delete record : Either database is down or there is branch recored exists for this role : "+e.data.message)):(t.showFailAlert("Fail to delete record : "),r.error("Fail to delete record : "+e.data.message)),c.getRole()}angular.forEach(c.gridApi.selection.getSelectedRows(),function(e,t){c.gridOptions.data.splice(c.gridOptions.data.lastIndexOf(e),1),o.deleteRole(e).then(n,a)})},c.openEditModal=function(e){n.open({templateUrl:"../partials/roleInputs.html",controller:"RoleEditController",resolve:{items:function(){return e.entity}}}).result.then(function(e){e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},c.openCreateModal=function(){n.open({templateUrl:"../partials/roleInputs.html",controller:"RoleCreateController"}).result.then(function(e){c.getRole(),e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},t.showSuccessAlert=function(e){t.messageSuccessText=e,t.alerts.push(e),i(function(){t.messageSuccessText="",t.alerts.splice(t.alerts.indexOf(alert),1)},5e3)},t.showFailAlert=function(e){t.messageFailText=e,t.alerts.push(e),i(function(){t.messageFailText="",t.alerts.splice(t.alerts.indexOf(alert),1)},1e4)},c.getRole=function(){0<c.responeData.length&&(c.responeData.length=[]),o.getRoles().then(function(e){c.pushGridData(e.data._embedded.roles)},function(e){console.log("Some erorr occure"+e)})},c.pushGridData=function(e){var t=1;e.forEach(function(e){e.id=t,t++,e.registered=new Date(e.registered),c.responeData.push(e)})},c.getRole(),c.refreshData=function(){c.gridOptions.data=a("filter")(c.responeData,c.searchText,void 0)},setSidebarMenuSelection("role")}]),myApp.controller("UploadFileController",["$rootScope","$window","uploadFileService","$scope","$filter","$timeout",function(e,t,n,o,a,l){setSidebarMenuSelection("fileupload"),e.logoutClicked=!1,o.uploadResult="",o.pageName="File Upload",o.pageUrl="fileupload",o.description="",o.files=[],o.branch=1,o.showGrid=!1,o.uploaded=!1,o.startDate="",o.endDate="",o.gridOptions={},o.msg={},o.rowDataArray=[],o.rowData={},o.duration=1,o.applyToAll=!1,o.messageSuccessText="",o.messageFailText="",o.alerts=[],o.gridOptions={enableSorting:!0,enableGridMenu:!0,paginationPageSizes:[2,3,5],paginationPageSize:5,enableColumnResizing:!0,rowEditWaitInterval:-1,enableRowHashing:!1,onRegisterApi:function(e){(o.gridApi=e).edit.on.afterCellEdit(o,function(e,t,n,a){n!=a&&(o.rowData={},o.rowData.id=e.id,o.rowData.column=t.name,o.rowData.contentName=e.contentName.substring(e.contentName.lastIndexOf("/")+1),"contentStatus"===t.name?o.rowData.data=1==n:o.rowData.data=n,"contentScheduleStart"!==t.name&&"contentScheduleEnd"!==t.name||(o.rowData.data=o.foramtDate(n)),o.rowData.branch=o.branch,o.rowDataArray.push(o.rowData))})},columnDefs:[{name:"id",enableCellEdit:!1,width:"10%"},{name:"contentName",displayName:"Image",enableCellEdit:!1,width:"20%",cellTemplate:"../partials/imageVideoTemplate.html"},{name:"contentStatus",displayName:"Status",editableCellTemplate:"ui-grid/dropdownEditor",width:"10%",cellFilter:"mapStatus",editDropdownValueLabel:"status",editDropdownOptionsArray:[{id:1,status:"active"},{id:0,status:"inactive"}]},{name:"contentScheduleStart",displayName:"Start Date",type:"date",cellFilter:'date:"dd-MM-yyyy"',width:"15%"},{name:"contentScheduleEnd",displayName:"End Date",type:"date",cellFilter:'date:"dd-MM-yyyy"',width:"15%"},{name:"duration",displayName:"Duration",type:"number",width:"15%"},{name:"contentOrder",displayName:"Dispaly Order",type:"number",width:"15%"}]},o.durationValues=[{id:1,value:1},{id:2,value:2},{id:3,value:4},{id:4,value:6},{id:5,value:8},{id:6,value:10},{id:7,value:15},{id:8,value:20},{id:9,value:30},{id:10,value:60}],o.contentIsImage=function(e){o.showImage=!0},o.saveState=function(){n.updateContent(o.rowDataArray,o.applyToAll).then(function(e){o.showSuccessAlert("Succesfull updated records"),o.getAllFiles(o.branch)},function(e){console.log(e),o.showFailAlert("Fail to update records")})},o.showSuccessAlert=function(e){o.messageSuccessText=e,o.alerts.push(e),l(function(){o.messageSuccessText="",o.alerts.splice(o.alerts.indexOf(alert),1)},3e3)},o.showFailAlert=function(e){o.messageFailText=e,o.alerts.push(e),l(function(){o.messageFailText="",o.alerts.splice(o.alerts.indexOf(alert),1)},3e3)},o.updateCheckBoxValue=function(){o.applyToAll=!o.applyToAll},o.getAllFiles=function(e){o.showGrid=!1,1===e&&(o.branch=1),n.getAllFiles(o.branch).then(function(e){var t=e.data;for(i=0;i<t.length;i++)t[i].contentScheduleStart=new Date(t[i].contentScheduleStart),t[i].contentScheduleEnd=new Date(t[i].contentScheduleEnd),t[i].contentStatus=t[i].contentStatus?1:0,t[i].showImage=t[i].contentType.includes("image"),t[i].showVideo=t[i].contentType.includes("video"),o.showGrid=!0;o.gridOptions.data=t,console.log("File Load successful")},function(e){console.log("File Load Fail")})},o.getAllFiles(1),o.upload=function(){var t=new FormData;t.append("description",o.description),t.append("branch",o.branch),t.append("startDate",o.startDate),t.append("endDate",o.endDate),t.append("duration",o.duration),angular.forEach(o.files,function(e){t.append("files",e)}),n.uploadFiles(t).then(function(e){o.uploaded=!0,o.getAllFiles(o.branch),console.log("File uploaded successful")},function(e){console.log("File uploaded Fail")})},o.foramtDate=function(e){var t=new Date(e),n=""+(t.getMonth()+1),a=""+t.getDate(),o=t.getFullYear();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),[o,n,a].join("-")},o.getBranches=function(){n.getBranches().then(function(e){o.branchList=e.data._embedded.branches,o.branchList.unshift({name:"All",id:0})},function(e){$log.error("Fail to upload files.")})},o.getBranches()}]).filter("mapStatus",function(){var t={1:"active",0:"inactive"};return function(e){return e?t[e]:"inactive"}}),myApp.controller("UserCreateController",["$uibModalInstance","$scope","userService",function(t,n,a){n.user={id:null,username:"",password:"",email:"",firstName:"",lastName:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",lattitude:"",longitude:"",phone1:"",phone2:"",email1:"",email2:"",role:""},n.createMode=!0,n.editMode=!1,n.roleList=[],n.newRole="",n.onCancel=function(){t.dismiss("cancel")},n.save=function(){var e=n.roleList.filter(function(e){return e.id==n.newRole});n.user.role={},n.user.role.id=e[0].id,n.user.role.name=e[0].name,a.createUser(n.user).then(function(e){200===e.status?t.close({messageSuccess:"New record created successfuly"}):t.close({messageFail:"Username already exists"})},function(e){t.close({messageFail:"Fail to create new record. Please check the log"})})},n.getRoles=function(){a.getRoles().then(function(e){n.roleList=e.data._embedded.roles,n.newRole=n.roleList[0].id.toString()},function(e){t.close({messageFail:"Fail to fetch role Details. Please check the log"}),$log.error("Fail to fetch role Details.")})},n.getRoles()}]),myApp.controller("UserEditController",["$uibModalInstance","$scope","items","userService","$log",function(t,n,e,a,o){n.user={id:null,username:"",password:"",firstName:"",lastName:"",addressLine2:"",addressLine2:"",country:"",state:"",city:"",zipcode:"",lattitude:"",longitude:"",phone1:"",phone2:"",email1:"",email2:"",role:""},n.user=e,n.editMode=!0,n.createMode=!1,n.roleList=[],n.newRole="",n.onCancel=function(){t.dismiss("cancel")},n.getRoles=function(){a.getRoles().then(function(e){n.roleList=e.data._embedded.roles,null!=n.user.role&&(n.newRole=n.user.role.id.toString())},function(e){t.close({messageFail:"Fail to fetch role Details. Please check the log"}),o.error("Fail to fetch role Details.")})},n.save=function(){console.log(n.newRole);var e=n.roleList.filter(function(e){return e.id==n.newRole});n.user.role=e[0],delete n.user.role._links,delete n.user._links,delete n.user.registered,delete n.user.slno,a.updateUser(n.user).then(function(e){t.close({messageSuccess:"Record updated successfuly"})},function(e){t.close({messageFail:"Fail to update. Please check the log"}),o.error("Fail to update")})},n.getRoles()}]),myApp.controller("UserController",["$scope","$http","$uibModal","userService","$filter","$interval","$timeout","uiGridConstants",function(t,e,n,o,a,l,i,s){var r=this;r.user={id:null,username:"",password:"",email:"",role:""},r.responeData=[],r.gridOptions=[],r.showSuccessAlert=!1,r.messageSuccessText="",t.messageFailText="",r.showModal=!1,t.alerts=[],r.enableDeleteButton=0,t.pageName="User",t.pageUrl="user",r.gridOptions={data:r.responeData,enableHighlighting:!0,enableRowHeaderSelection:!1,enableSorting:!0,exporterMenuCsv:!1,enableGridMenu:!0,paginationPageSizes:[25,50,75],paginationPageSize:15,enableColumnResizing:!0,enableRowSelection:!0,appScopeProvider:{onDblClick:function(e){r.openEditModal(e)}},rowTemplate:"../partials/uiGridTemplate.html",onRegisterApi:function(e){r.gridApi=e,r.gridApi.core.handleWindowResize(),e.selection.on.rowSelectionChanged(t,function(e){e.isSelected?r.enableDeleteButton=r.enableDeleteButton+1:r.enableDeleteButton=r.enableDeleteButton-1}),e.selection.on.rowSelectionChangedBatch(t,function(e){var t="rows changed "+e.length;console.log(t)})},columnDefs:[{name:"slno",displayName:"Sr. No.",width:80,enableFiltering:!1,cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"username",displayName:"User Name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"email",displayName:"Email",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"},{field:"role.name",displayName:"Role Name",cellClass:"noborder",cellTooltip:"Select to delete and dubble click to edit"}]},r.deleteSelected=function(){function n(e){r.enableDeleteButton=0,t.showSuccessAlert("Record deleted successfully")}function a(e){t.showFailAlert("Fail to delete record"+e.data.message)}angular.forEach(r.gridApi.selection.getSelectedRows(),function(e,t){r.gridOptions.data.splice(r.gridOptions.data.lastIndexOf(e),1),o.deleteUser(e).then(n,a)})},r.openEditModal=function(e){e.entity.password="",n.open({templateUrl:"../partials/userInputs.html",controller:"UserEditController",resolve:{items:function(){return e.entity}}}).result.then(function(e){e.messageSuccess?(r.enableDeleteButton=0,r.getUser(),t.showSuccessAlert(e.messageSuccess)):t.showFailAlert(e.messageFail)},function(){})},r.openCreateModal=function(){n.open({templateUrl:"../partials/userInputs.html",controller:"UserCreateController"}).result.then(function(e){r.getUser(),e.messageSuccess?t.showSuccessAlert(e.messageSuccess):t.showFailAlert(e.messageFail)},function(){})},t.showSuccessAlert=function(e){t.messageSuccessText=e,t.alerts.push(e),i(function(){t.messageSuccessText="",t.alerts.splice(t.alerts.indexOf(alert),1)},3e3)},t.showFailAlert=function(e){t.messageFailText=e,t.alerts.push(e),i(function(){t.messageFailText="",t.alerts.splice(t.alerts.indexOf(alert),1)},3e3)},r.getUser=function(){0<r.responeData.length&&(r.responeData.length=[]),o.getUsers().then(function(e){r.pushGridData(e.data._embedded.users)},function(e){console.log("Some erorr occure"+e)})},r.pushGridData=function(e){var t=1;e.forEach(function(e){e.slno=t,t++,e.registered=new Date(e.registered),r.responeData.push(e)})},r.getUser(),r.refreshData=function(){r.gridOptions.data=a("filter")(r.responeData,r.searchText,void 0)},setSidebarMenuSelection("user")}]);